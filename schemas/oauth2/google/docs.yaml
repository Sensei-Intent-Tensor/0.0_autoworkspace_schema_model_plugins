openapi: "3.1.0"
info:
  title: Google Docs API
  version: "1.0.0"
  description: |
    Drop-in schema for Google Docs API.
    
    ## Required Placeholders
    - `{{CLIENT_ID}}`: Your Google OAuth client ID
    - `{{CLIENT_SECRET}}`: Your Google OAuth client secret
    - `{{CALLBACK_URL}}`: Your platform's OAuth callback URL
    
    ## Scopes
    - `https://www.googleapis.com/auth/documents` - Full Docs access
    - `https://www.googleapis.com/auth/documents.readonly` - Read-only access
    - `https://www.googleapis.com/auth/drive.file` - Files created/opened by app
    
    ## Auth Type
    OAuth2 Authorization Code
    
    ## ChatGPT Compatible
    Yes
    
    ## Note
    Creating new documents requires `drive.file` scope in addition to `documents`.
  contact:
    name: Auto-Workspace-AI
    url: https://auto-workspace-ai.com

servers:
  - url: https://docs.googleapis.com/v1
    description: Google Docs API v1

components:
  securitySchemes:
    OAuth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: https://accounts.google.com/o/oauth2/v2/auth
          tokenUrl: https://oauth2.googleapis.com/token
          scopes:
            https://www.googleapis.com/auth/documents: Full access to Docs
            https://www.googleapis.com/auth/documents.readonly: Read-only access
            https://www.googleapis.com/auth/drive.file: Access files created by app

  schemas:
    Document:
      type: object
      properties:
        documentId:
          type: string
          description: Unique document identifier
        title:
          type: string
          description: Document title
        body:
          $ref: '#/components/schemas/Body'
        headers:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/Header'
        footers:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/Footer'
        documentStyle:
          $ref: '#/components/schemas/DocumentStyle'
        revisionId:
          type: string
        suggestionsViewMode:
          type: string
          enum: [DEFAULT_FOR_CURRENT_ACCESS, SUGGESTIONS_INLINE, PREVIEW_SUGGESTIONS_ACCEPTED, PREVIEW_WITHOUT_SUGGESTIONS]

    Body:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: '#/components/schemas/StructuralElement'

    StructuralElement:
      type: object
      properties:
        startIndex:
          type: integer
        endIndex:
          type: integer
        paragraph:
          $ref: '#/components/schemas/Paragraph'
        table:
          $ref: '#/components/schemas/Table'
        sectionBreak:
          type: object

    Paragraph:
      type: object
      properties:
        elements:
          type: array
          items:
            $ref: '#/components/schemas/ParagraphElement'
        paragraphStyle:
          $ref: '#/components/schemas/ParagraphStyle'

    ParagraphElement:
      type: object
      properties:
        startIndex:
          type: integer
        endIndex:
          type: integer
        textRun:
          type: object
          properties:
            content:
              type: string
            textStyle:
              $ref: '#/components/schemas/TextStyle'

    TextStyle:
      type: object
      properties:
        bold:
          type: boolean
        italic:
          type: boolean
        underline:
          type: boolean
        strikethrough:
          type: boolean
        fontSize:
          type: object
          properties:
            magnitude:
              type: number
            unit:
              type: string
        foregroundColor:
          type: object
          properties:
            color:
              type: object
              properties:
                rgbColor:
                  type: object
                  properties:
                    red:
                      type: number
                    green:
                      type: number
                    blue:
                      type: number
        link:
          type: object
          properties:
            url:
              type: string

    ParagraphStyle:
      type: object
      properties:
        namedStyleType:
          type: string
          enum: [NORMAL_TEXT, TITLE, SUBTITLE, HEADING_1, HEADING_2, HEADING_3, HEADING_4, HEADING_5, HEADING_6]
        alignment:
          type: string
          enum: [START, CENTER, END, JUSTIFIED]
        lineSpacing:
          type: number
        spaceAbove:
          type: object
          properties:
            magnitude:
              type: number
            unit:
              type: string
        spaceBelow:
          type: object
          properties:
            magnitude:
              type: number
            unit:
              type: string

    Table:
      type: object
      properties:
        rows:
          type: integer
        columns:
          type: integer
        tableRows:
          type: array
          items:
            type: object
            properties:
              tableCells:
                type: array
                items:
                  type: object
                  properties:
                    content:
                      type: array
                      items:
                        $ref: '#/components/schemas/StructuralElement'

    Header:
      type: object
      properties:
        headerId:
          type: string
        content:
          type: array
          items:
            $ref: '#/components/schemas/StructuralElement'

    Footer:
      type: object
      properties:
        footerId:
          type: string
        content:
          type: array
          items:
            $ref: '#/components/schemas/StructuralElement'

    DocumentStyle:
      type: object
      properties:
        marginTop:
          type: object
          properties:
            magnitude:
              type: number
            unit:
              type: string
        marginBottom:
          type: object
        marginLeft:
          type: object
        marginRight:
          type: object
        pageSize:
          type: object
          properties:
            width:
              type: object
            height:
              type: object

    Request:
      type: object
      description: A single update request
      properties:
        insertText:
          type: object
          properties:
            location:
              type: object
              properties:
                index:
                  type: integer
            text:
              type: string
        deleteContentRange:
          type: object
          properties:
            range:
              type: object
              properties:
                startIndex:
                  type: integer
                endIndex:
                  type: integer
        updateTextStyle:
          type: object
          properties:
            range:
              type: object
              properties:
                startIndex:
                  type: integer
                endIndex:
                  type: integer
            textStyle:
              $ref: '#/components/schemas/TextStyle'
            fields:
              type: string
        updateParagraphStyle:
          type: object
          properties:
            range:
              type: object
              properties:
                startIndex:
                  type: integer
                endIndex:
                  type: integer
            paragraphStyle:
              $ref: '#/components/schemas/ParagraphStyle'
            fields:
              type: string
        insertTable:
          type: object
          properties:
            rows:
              type: integer
            columns:
              type: integer
            location:
              type: object
              properties:
                index:
                  type: integer
        replaceAllText:
          type: object
          properties:
            containsText:
              type: object
              properties:
                text:
                  type: string
                matchCase:
                  type: boolean
            replaceText:
              type: string

security:
  - OAuth2:
      - https://www.googleapis.com/auth/documents

paths:
  /documents:
    post:
      operationId: createDocument
      summary: Create a new document
      description: Creates a new blank Google Doc
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - title
              properties:
                title:
                  type: string
                  description: Document title
      responses:
        '200':
          description: Created document
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Document'

  /documents/{documentId}:
    get:
      operationId: getDocument
      summary: Get a document
      description: Returns the full document content and structure
      parameters:
        - name: documentId
          in: path
          required: true
          schema:
            type: string
        - name: suggestionsViewMode
          in: query
          description: How to display suggestions
          schema:
            type: string
            enum: [DEFAULT_FOR_CURRENT_ACCESS, SUGGESTIONS_INLINE, PREVIEW_SUGGESTIONS_ACCEPTED, PREVIEW_WITHOUT_SUGGESTIONS]
      responses:
        '200':
          description: Document content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Document'

  /documents/{documentId}:batchUpdate:
    post:
      operationId: batchUpdateDocument
      summary: Update document content
      description: |
        Applies multiple updates to a document atomically.
        
        Common operations:
        - insertText: Add text at a position
        - deleteContentRange: Remove text
        - updateTextStyle: Change formatting (bold, italic, etc.)
        - updateParagraphStyle: Change alignment, headings
        - insertTable: Add a table
        - replaceAllText: Find and replace
      parameters:
        - name: documentId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - requests
              properties:
                requests:
                  type: array
                  items:
                    $ref: '#/components/schemas/Request'
                writeControl:
                  type: object
                  properties:
                    requiredRevisionId:
                      type: string
                      description: Only apply if doc hasn't changed
            examples:
              insertText:
                summary: Insert text at beginning
                value:
                  requests:
                    - insertText:
                        location:
                          index: 1
                        text: "Hello, World!"
              replaceText:
                summary: Find and replace
                value:
                  requests:
                    - replaceAllText:
                        containsText:
                          text: "old text"
                          matchCase: true
                        replaceText: "new text"
              formatBold:
                summary: Make text bold
                value:
                  requests:
                    - updateTextStyle:
                        range:
                          startIndex: 1
                          endIndex: 10
                        textStyle:
                          bold: true
                        fields: "bold"
      responses:
        '200':
          description: Update results
          content:
            application/json:
              schema:
                type: object
                properties:
                  documentId:
                    type: string
                  replies:
                    type: array
                    items:
                      type: object
                  writeControl:
                    type: object
                    properties:
                      requiredRevisionId:
                        type: string
